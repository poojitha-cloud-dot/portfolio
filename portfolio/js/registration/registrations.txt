<?php
// registration/view.php
$file = __DIR__ . '/registrations.txt';
$rows = [];

if (file_exists($file)) {
    $lines = file($file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);
    foreach ($lines as $line) {
        $parts = explode('|', $line);
        // expected: name|email|phone|course|timestamp
        if (count($parts) >= 5) {
            $rows[] = $parts;
        }
    }
}
?>
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Registered Students</title>
  <style>
    body{font-family:Arial,Helvetica,sans-serif;background:#f7fafc;color:#333}
    .container{max-width:900px;margin:2rem auto;background:#fff;padding:1rem;border-radius:8px}
    table{width:100%;border-collapse:collapse}
    th,td{border:1px solid #e5e7eb;padding:.6rem;text-align:left}
  </style>
</head>
<body>
  <div class="container">
    <h1>Registered Students</h1>
    <?php if (empty($rows)): ?>
      <p>No registrations yet.</p>
    <?php else: ?>
      <table>
        <thead><tr><th>#</th><th>Name</th><th>Email</th><th>Phone</th><th>Course</th><th>Time</th></tr></thead>
        <tbody>
          <?php foreach ($rows as $i => $r): ?>
            <tr>
              <td><?php echo $i+1; ?></td>
              <td><?php echo htmlspecialchars($r[0]); ?></td>
              <td><?php echo htmlspecialchars($r[1]); ?></td>
              <td><?php echo htmlspecialchars($r[2]); ?></td>
              <td><?php echo htmlspecialchars($r[3]); ?></td>
              <td><?php echo htmlspecialchars($r[4]); ?></td>
            </tr>
          <?php endforeach; ?>
        </tbody>
      </table>
    <?php endif; ?>

    <p><a href="index.html">Back to form</a></p>
  </div>
</body>
</html>
